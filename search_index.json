[
["intro.html", "Chapter 1 The Targeted Learning Roadmap 1.1 The Statistical Model 1.2 The Causal Model 1.3 The Parameter of Interest 1.4 Identifiability 1.5 Estimators: SuperLearning and Targeted Maximum Likelihood 1.6 The WASH Benefits Example Dataset", " Chapter 1 The Targeted Learning Roadmap A central goal of the Targeted Learning statistical paradigm is to estimate scientifically relevant parameters in realistic (usually nonparametric) models. 1.1 The Statistical Model Assume we have an i.i.d. sample of confounders, a binary intervention of interest, and an outcome, or are observed data is \\(O = (W, A, Y)\\). The distribution of the observed data may be factorized as follows: \\(P(O) = P(W, A, Y) = P(W)P (A \\mid W) P(Y \\mid A, W)\\). To estimate a parameter of interest, a researcher need not necessarily be able to specify these whole or conditional distributions. Rather, each estimator only requires that certain parts of the distribution be known; for example, some may require estimates of \\(\\mathbb{E}(Y \\mid A, W)\\), the mean of \\(Y\\) within subgroups \\((A, W)\\), or the regression of the outcome on the exposure and confounders. At this stage in the roadmap, the researcher must specify a choice of statistical model to be used in estimating \\(\\mathbb{E}(Y \\mid A, W)\\) or other elements of the probability distribution needed to estimate the parameter of interest. Here, statistical model means any constraints on the model form that may be imposed by knowledge about the data-generating process – that is, known aspects of how the data were generated. Typically, the true model is a very large model, placing few constraints, if any, on the data-generating distribution, or a semi-parametric model. With few constraints on the data-generating distribution, and a potentially large number of covariates, data-adaptive, machine-learning approaches remain the only practical option for estimating components of the likelihood. The remainder of this course concerns how to do this as efficiently and robustly as possible, depending on the goal of the analysis. 1.2 The Causal Model The next step in the roadmap is to use a causal framework to formalize the experiment and thereby define the parameter of interest. Causal graphs are one useful tool to express what we know about the causal relations among variables that are relevant to the question under study (Pearl 2009). Ignoring error terms, we will assume the following ordering of the variables in \\(O\\). While directed acyclic graphs (DAGs - like above) provide a convenient means by which to visualize causal relations between variables, the causal relations among variables can be represented via a set of structural equations: \\[\\begin{align*} W &amp;= f_W(U_W) \\\\ A &amp;= f_A(W, U_A) \\\\ Y &amp;= f_Y(W, A, U_Y), \\end{align*}\\] where \\(U_W\\), \\(U_A\\), and \\(U_Y\\) represent the unmeasured exogenous background characteristics that influence the value of each variable. In the NPSEM, \\(f_W\\), \\(f_A\\) and \\(f_Y\\) denote that each variable (for \\(W\\), \\(A\\) and \\(Y\\), respectively) is a function of its parents and unmeasured background characteristics, but one typically has little information about particular functional constraints (e.g., linear, logit-linear, only one interaction, etc.). For this reason, they are called non-parametric structural equation models (NPSEMs). The DAG and set of nonparametric structural equations represent exactly the same information and so may be used interchangeably. 1.3 The Parameter of Interest The first hypothetical experiment we will consider is assigning exposure to the whole population and observing the outcome, and then assigning no exposure to the whole population and observing the outcome. On the nonparametric structural equations, this corresponds to a comparison of the outcome distribution in the population under two interventions: \\(A\\) is set to \\(1\\) for all individuals, and \\(A\\) is set to \\(0\\) for all individuals. These interventions imply two new nonparametric structural equation models. For the case \\(A = 1\\), we have \\[\\begin{align*} W &amp;= f_W(U_W) \\\\ A &amp;= 1 \\\\ Y(1) &amp;= f_Y(W, 1, U_Y), \\end{align*}\\] and for the case \\(A=0\\), \\[\\begin{align*} W &amp;= f_W(U_W) \\\\ A &amp;= 0 \\\\ Y(1) &amp;= f_Y(W, 0, U_Y). \\end{align*}\\] In these equations, \\(A\\) is no longer a function of \\(W\\) because we have intervened on the system, setting \\(A\\) deterministically to either of the values \\(1\\) or \\(0\\). The new symbols \\(Y(1)\\) and \\(Y(0)\\) indicate the outcome variable in our population if it were generated by the respective NPSEMs above; these are often called counterfactuals. The difference between the means of the outcome under these two interventions defines a parameter that is often called the “average treatment effect” (ATE), denoted \\[\\begin{equation}\\label{eqn:ate} ATE = \\mathbb{E}_X(Y(1)-Y(0)), \\end{equation}\\] where \\(\\mathbb{E}_X\\) is the mean under the theoretical (unobserved) full data \\(X = (W, Y(1), Y(0))\\). 1.4 Identifiability Because we can never observe both \\(Y(0)\\) (the counterfactual outcome when \\(A=0\\)) and \\(Y(1)\\), we cannot estimate directly. Instead, we have to make assumptions under which this quantity may be estimated from the observed data \\(O \\sim P_0\\) under the data-generating distribution \\(P_0\\). Fortunately, given the causal model specified in the NPSEM above, we can, with a handful of untestable assumptions, estimate the ATE, even from observational data. These assumptions may be summarized as follows The causal graph implies \\(Y(a) \\perp A\\) for all \\(a \\in \\mathcal{A}\\), which is the randomization assumption. In the case of observational data, the analogous assumption is strong ignorability or no unmeasured confounding \\(Y(a) \\perp A \\mid W\\) for all \\(a \\in \\mathcal{A}\\); Although not represented in the causal graph, also required is the assumption of no interference between units, that is, the outcome for unit \\(i\\) \\(Y_i\\) is not affected by exposure for unit \\(j\\) \\(A_j\\) unless \\(i=j\\); Consistency of the treatment mechanism is also required, i.e., the outcome for unit \\(i\\) is \\(Y_i(a)\\) whenever \\(A_i = a\\), an assumption also known as “no other versions of treatment”; It is also necessary that all observed units, across strata defined by \\(W\\), have a bounded (non-deterministic) probability of receiving treatment – that is, \\(0 &lt; P_0(A = a \\mid W) &lt; 1\\) for all \\(a\\) and \\(W\\)). This assumption is referred to as positivity. Remark: Together, (2) and (3), the assumptions of no interference and consistency, respectively, are jointly referred to as the stable unit treatment value assumption (SUTVA). Given these assumptions, the ATE may be re-written as a function of \\(P_0\\), specifically \\[\\begin{equation}\\label{eqn:estimand} ATE = \\mathbb{E}_0(Y(1) - Y(0)) = \\mathbb{E}_0 \\left(\\mathbb{E}_0[Y \\mid A = 1, W] - \\mathbb{E}_0[Y \\mid A = 0, W]\\right), \\end{equation}\\] or the difference in the predicted outcome values for each subject, under the contrast of treatment conditions (\\(A = 0\\) vs. \\(A = 1\\)), in the population, averaged over all observations. Thus, a parameter of a theoretical “full” data distribution can be represented as an estimand of the observed data distribution. Significantly, there is nothing about the representation in that requires parameteric assumptions; thus, the regressions on the right hand side may be estimated freely with machine learning. With different parameters, there will be potentially different identifiability assumptions and the resulting estimands can be functions of different components of \\(P_0\\). We discuss several more complex estimands in later sections of this workshop. 1.5 Estimators: SuperLearning and Targeted Maximum Likelihood Although we will discuss more in later sections, the goals of the estimators we desire should be that, among sensible (asymptotically consistent, regular) estimators, the estimator be asymptotically efficient in the statistical model of interest, and the estimator can be constructed for finite-sample performance improvements, relative to other estimators in the same class. These priniciples guide our approach to estimation: Superlearning for prediction (more generally density estimation) and TMLE for estimation of our intervention parameters of interest. 1.5.1 SuperLearning There is no universally optimal machine learning algorithm (exceptions exist - HAL). This is true empirically, when we have test different algorithms on actual data and looked at the performance (e.g., MSE of prediction) For some data, one needs learners that can model a complex function. For others, typically caused by noise or insufficient sample size, a simple, parametric model might fit the best. SuperLearner, an ensemble learner, solves this issue, by allowing a convex combination of learners from the simplest (intercept-only) to most complex (neural nets, random forests, SVM, etc.). It works by using cross-validation in a manner which guarantees that the resulting fit will be as good as possible, given the learners provided (note, even a convex combination of poor learners can sometimes result in good fit, though better to have good candidates). ] 1.5.2 TMLE 1.5.3 Inference The estimators we discuss are asymptotically linear, meaning that the difference in the estimate \\(\\Psi(P_n)\\) and the true parameter (\\(\\Psi(P_0)\\)) can be represented in first order by a i.i.d. sum: \\[\\begin{equation}\\label{eqn:IC} \\Psi(P_n) - \\Psi(P_0) = \\frac{1}{n} IC(O_i; \\nu) + op(1/\\sqrt{n}) \\end{equation}\\] where \\(IC(O_i; \\nu)\\) is a function of the data and possibly other parameters \\(\\nu\\). Importantly, such estimators have mean-zero Gaussian limiting distributions; thus, in the univariate case, one has that \\[\\begin{equation}\\label{eqn:limit_dist} \\sqrt{n}(\\Psi(P_n) - \\Psi(P_0)) = N(0, (IC(O_i; \\nu))^2), \\end{equation}\\] so that inference for the estimator of interest may be obtained in terms of the influence function. For this simple case, a 95% confidence interval may be derived as: \\[\\begin{equation}\\label{eqn:CI} \\Psi(P^{\\star}_n) \\pm 1.96 \\sqrt{\\frac{\\hat{\\sigma}^2}{n}}, \\end{equation}\\] where \\(SE=\\sqrt{\\frac{\\hat{\\sigma}^2}{n}}\\) and \\(\\hat{\\sigma}^2\\) is the sample variance of the estimated IC’s: \\(IC(O; \\hat{\\nu})\\). One can use the functional delta method to derive the influence curve if a parameter of interest may be written as a function of other asymptotically linear estimators. 1.6 The WASH Benefits Example Dataset The data come from a study of the effect of water quality, sanitation, hand washing, and nutritional interventions on child development in rural Bangladesh (WASH Benefits Bangladesh): a cluster-randomised controlled trial (“Temporary,” n.d.). The study enrolled pregnant women in their first or second trimester from the rural villages of Gazipur, Kishoreganj, Mymensingh, and Tangail districts of central Bangladesh, with an average of eight women per cluster. Groups of eight geographically adjacent clusters were block-randomised, using a random number generator, into six intervention groups (all of which received weekly visits from a community health promoter for the first 6 months and every 2 weeks for the next 18 months) and a double-sized control group (no intervention or health promoter visit). The six intervention groups were: chlorinated drinking water; improved sanitation; handwashing with soap; combined water, sanitation, and hand washing; improved nutrition through counseling and provision of lipid-based nutrient supplements; and combined water, sanitation, handwashing, and nutrition. In the workshop, we concentrate on child growth (size for age) as the outcome of interest. For referene, this trial was registered with ClinicalTrials.gov as NCT01590095. library(here) library(tidyverse) # read in data dat &lt;- read_csv(here(&quot;data&quot;, &quot;washb_data.csv&quot;)) dat ## # A tibble: 4,695 x 28 ## whz tr fracode month aged sex momage momedu momheight hfiacat ## &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 0 Cont… N05265 9 268 male 30 Prima… 146. Food S… ## 2 -1.16 Cont… N05265 9 286 male 25 Prima… 149. Modera… ## 3 -1.05 Cont… N08002 9 264 male 25 Prima… 152. Food S… ## 4 -1.26 Cont… N08002 9 252 fema… 28 Prima… 140. Food S… ## 5 -0.59 Cont… N06531 9 336 fema… 19 Secon… 151. Food S… ## 6 -0.51 Cont… N06531 9 304 male 20 Secon… 154. Severe… ## 7 -2.46 Cont… N08002 9 336 fema… 19 Prima… 151. Food S… ## 8 -0.6 Cont… N06528 9 312 fema… 25 No ed… 142. Food S… ## 9 -0.23 Cont… N06528 9 322 male 30 Secon… 153. Food S… ## 10 -0.14 Cont… N06453 9 376 male 30 No ed… 156. Modera… ## # … with 4,685 more rows, and 18 more variables: Nlt18 &lt;dbl&gt;, Ncomp &lt;dbl&gt;, ## # watmin &lt;dbl&gt;, elec &lt;dbl&gt;, floor &lt;dbl&gt;, walls &lt;dbl&gt;, roof &lt;dbl&gt;, ## # asset_wardrobe &lt;dbl&gt;, asset_table &lt;dbl&gt;, asset_chair &lt;dbl&gt;, ## # asset_khat &lt;dbl&gt;, asset_chouki &lt;dbl&gt;, asset_tv &lt;dbl&gt;, ## # asset_refrig &lt;dbl&gt;, asset_bike &lt;dbl&gt;, asset_moto &lt;dbl&gt;, ## # asset_sewmach &lt;dbl&gt;, asset_mobile &lt;dbl&gt; For the purposes of this workshop, we we start by treating the data as independent and identically distributed (i.i.d.) random draws from a very large target population. We could, with available options, account for the clustering of the data (within sampled geographic units), but, for simplification, we avoid these details in these workshop presentations, although modifications of our methodology for biased samples, repeated measures, etc., are available. We have 28 variables measured, of which 1 variable is set to be the outcome of interest. This outcome, \\(Y\\), is the weight-for-height Z-score (whz in dat); the treatment of interest, \\(A\\), is the randomized treatment group (tr in dat); and the adjustment set, \\(W\\), consists simply of everything else. This results in our observed data structure being \\(n\\) i.i.d. copies of \\(O_i = (W_i, A_i, Y_i)\\), for \\(i = 1, \\ldots, n\\). 1.6.1 The variables Using the skimr package, we can quickly summarize the variables measured in the WASH Benefits data set: library(skimr) skim(dat) ## Skim summary statistics ## n obs: 4695 ## n variables: 28 ## ## Variable type: character ## variable missing complete n min max empty n_unique ## fracode 0 4695 4695 2 6 0 20 ## hfiacat 0 4695 4695 11 24 0 4 ## momedu 0 4695 4695 12 15 0 3 ## sex 0 4695 4695 4 6 0 2 ## tr 0 4695 4695 3 15 0 7 ## ## Variable type: numeric ## variable missing complete n mean sd p0 p25 median ## aged 0 4695 4695 266.32 52.17 42 230 266 ## asset_bike 0 4695 4695 0.32 0.47 0 0 0 ## asset_chair 0 4695 4695 0.73 0.44 0 0 1 ## asset_chouki 0 4695 4695 0.78 0.41 0 1 1 ## asset_khat 0 4695 4695 0.61 0.49 0 0 1 ## asset_mobile 0 4695 4695 0.86 0.35 0 1 1 ## asset_moto 0 4695 4695 0.066 0.25 0 0 0 ## asset_refrig 0 4695 4695 0.079 0.27 0 0 0 ## asset_sewmach 0 4695 4695 0.065 0.25 0 0 0 ## asset_table 0 4695 4695 0.73 0.44 0 0 1 ## asset_tv 0 4695 4695 0.3 0.46 0 0 0 ## asset_wardrobe 0 4695 4695 0.17 0.37 0 0 0 ## elec 0 4695 4695 0.6 0.49 0 0 1 ## floor 0 4695 4695 0.11 0.31 0 0 0 ## momage 18 4677 4695 23.91 5.24 14 20 23 ## momheight 31 4664 4695 150.5 5.23 120.65 147.05 150.6 ## month 0 4695 4695 6.45 3.33 1 4 6 ## Ncomp 0 4695 4695 11.04 6.35 2 6 10 ## Nlt18 0 4695 4695 1.6 1.25 0 1 1 ## roof 0 4695 4695 0.99 0.12 0 1 1 ## walls 0 4695 4695 0.72 0.45 0 0 1 ## watmin 0 4695 4695 0.95 9.48 0 0 0 ## whz 0 4695 4695 -0.59 1.03 -4.67 -1.28 -0.6 ## p75 p100 hist ## 303 460 ▁▁▂▇▇▅▁▁ ## 1 1 ▇▁▁▁▁▁▁▃ ## 1 1 ▃▁▁▁▁▁▁▇ ## 1 1 ▂▁▁▁▁▁▁▇ ## 1 1 ▅▁▁▁▁▁▁▇ ## 1 1 ▁▁▁▁▁▁▁▇ ## 0 1 ▇▁▁▁▁▁▁▁ ## 0 1 ▇▁▁▁▁▁▁▁ ## 0 1 ▇▁▁▁▁▁▁▁ ## 1 1 ▃▁▁▁▁▁▁▇ ## 1 1 ▇▁▁▁▁▁▁▃ ## 0 1 ▇▁▁▁▁▁▁▂ ## 1 1 ▆▁▁▁▁▁▁▇ ## 0 1 ▇▁▁▁▁▁▁▁ ## 27 60 ▅▇▅▂▁▁▁▁ ## 154.06 168 ▁▁▁▂▇▇▂▁ ## 9 12 ▅▃▇▃▂▇▃▅ ## 14 52 ▇▇▃▁▁▁▁▁ ## 2 10 ▇▃▂▁▁▁▁▁ ## 1 1 ▁▁▁▁▁▁▁▇ ## 1 1 ▃▁▁▁▁▁▁▇ ## 1 600 ▇▁▁▁▁▁▁▁ ## 0.08 4.97 ▁▁▅▇▃▁▁▁ A convenient summary of the relevant variables is given just above, complete with a small visualization describing the marginal characteristics of each covariate. Note that the asset variables reflect socio-economic status of the study participants. Notice also the uniform distribution of the treatment groups (with twice as many controls); this is, of course, by design. References "]
]
